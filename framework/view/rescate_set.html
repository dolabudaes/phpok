<!-- include tpl=head_lay -->
<style>
	.layui-form-label{width: 12%}
</style>
<div class="layui-row layui-col-space15">
	<div class="layui-col-md12">
		<div class="layui-card">
			<div class="layui-card-header">{lang添加附件分类}</div>
			<form method="post" id="catesubmit">
				<input type="hidden" name="id" id="id" value="{$id}" />
				<div class="layui-card-body">
					<div class="layui-btn-group test-table-operate-btn" style="margin-bottom: 10px;">
						<button type="button" class="layui-btn layuiadmin-btn-list" onclick="$.phpok.go('{url ctrl=rescate/}')">返回</button>
					</div>
					<div class="layui-form">
						<div class="layui-form-item">
							<label class="layui-form-label">{lang分类名称}</label>
							<div class="layui-input-inline" style="width: 350px;">
								<input type="text" name="title" id="title" value="{$rs.title}" class="layui-input">
							</div>
							<div class="layui-form-mid layui-word-aux">{lang请设置附件分类名称，如图片库，影音库等，以方便管理}</div>
						</div>
						<div class="layui-form-item">
							<label class="layui-form-label">{lang存储目录}</label>
							<div class="layui-input-inline" style="width: 500px;">
								<input type="text" name="root" id="root" value="{$rs.root}" class="layui-input">
							</div>
							<div class="layui-form-mid layui-word-aux">{lang相对于程序的根目而设，建议设置在res/之下的目录}</div>
						</div>
						<div class="layui-form-item">
							<label class="layui-form-label">{lang创建子文件夹方式}</label>
							<div class="layui-input-inline" style="width: 350px">
								<select name="folder">
									<option value="">不创建文件夹</option>
									<option value="Ym/d/"{if $rs.folder == 'Ym/d/'}selected{/if}>{lang年月/日/，示例：}{func date Ym/d/}</option>
									<option value="Y/m/d/"{if $rs.folder == 'Y/m/d/'}selected{/if}>{lang年/月/日/，示例：}{func date Y/m/d/}</option>
									<option value="Ymd/"{if $rs.folder == 'Ymd/'}selected{/if}>{lang年月日/，示例：}{func date Ymd/}</option>
									<option value="Y/m/"{if $rs.folder == 'Y/m/'}selected{/if}>{lang年/月/，示例：}{func date Y/m/}</option>
									<option value="Y/"{if $rs.folder == 'Y/'}selected{/if}>{lang年/，示例：}{func date Y/}</option>
								</select>
							</div>
							<div class="layui-form-mid layui-word-aux">{lang设置是否创建子文件夹}</div>
						</div>
						<div class="layui-form-item">
							<label class="layui-form-label">{lang是否默认使用}</label>
							<div class="layui-input-inline">
								<input type="checkbox" name="is_default" id="is_default" lay-skin="switch" value="1" {if $rs.is_default} checked{/if}>
							</div>
							<div class="layui-form-mid layui-word-aux">{lang当前端或未指定附件分类时，将使用这个默认来读取。整个附件分类管理中仅限支持一个}</div>
						</div>
						<div class="layui-form-item">
							<label class="layui-form-label">{lang支持的附件类型}</label>
							<div class="layui-input-inline" style="width: 500px;">
								<input type="text" id="filetypes" name="filetypes" value="{$rs.filetypes}" class="layui-input">
							</div>
							<div class="layui-form-mid layui-word-aux">{lang多种附件类型用英文逗号隔开，如jpg,gif,png，以此类推}</div>
						</div>
						<div class="layui-form-item">
							<label class="layui-form-label">{lang类型说明}</label>
							<div class="layui-input-inline" style="width: 500px;">
								<input type="text" id="typeinfo" name="typeinfo" value="{$rs.typeinfo}" class="layui-input">
							</div>
							<div class="layui-form-mid layui-word-aux">{lang描述上传的附件类型信息，如jpg,gif,png，可以描述为图片文件，rar,zip等可以描述为压缩文件}</div>
						</div>
						<div class="layui-form-item">
							<label class="layui-form-label">{lang上传大小限制}</label>
							<div class="layui-input-inline" style="width: 350px;">
								<input type="text" id="filemax" name="filemax" value="{$rs.filemax}" class="layui-input">
							</div>
							<div class="layui-form-mid layui-word-aux">{lang设置该分类下能上传的文件大小，只需填写数值，不能超过PHP系统限制的：}<span class="layui-bg-red">{func get_cfg_var upload_max_filesize}B</span></div>
						</div>
						<div class="layui-form-item">
							<label class="layui-form-label">{lang图片方案生成定制}</label>
							<div class="layui-input-inline" style="width: 350px;">
								<input type="radio" name="gdall" title="{lang全部使用}" lay-filter="gdall" value="1"{if $rs.gdall} checked{/if} />
								<input type="radio" name="gdall" title="{lang自定义使用}" lay-filter="gdall" value="0"{if !$rs.gdall} checked{/if} />
							</div>
							<div class="layui-form-mid layui-word-aux">{lang即上传到该分类下的图片，是否使用GD配置生成特定的图片规格}</div>
						</div>
						<div class="layui-form-item" id="gdsetting">
							<label class="layui-form-label">{lang自定义要生成的GD方案}</label>
							<div class="layui-input-inline" style="width: 350px;">
								<table class="layui-table">
									<colgroup>
										<col width="150">
										<col width="200">
									</colgroup>
									<thead>
									<tr>
										<th>标识</th>
										<th>规格</th>
									</tr>
									</thead>
									<tbody>
									<!-- loop from=$gdlist key=$key value=$value id=$tmpid -->
									<tr>
										<td><input type="checkbox" name="gdtypes[]" id="gdtypes{$value.id}" title="{$value.identifier}" value="{$value.id}"{if in_array($value.id,$rs.gdtypes)} checked{/if} /> </td>
										<td><label for="gdtypes{$value.id}">{$value.width ? $value.width : '自动判定'} x {$value.height ? $value.height : '自动判定'}</label></td>
									</tr>
									<!-- /loop -->
									</tbody>
								</table>
							</div>
							<div class="layui-form-mid layui-word-aux">{lang全部不选表示不使用GD方案}</div>
						</div>
						<div class="layui-form-item">
							<label class="layui-form-label">{lang后台缩略图}</label>
							<div class="layui-input-inline" style="width: 350px;">
								<input type="radio" name="ico" title="{lang启用}" value="1"{if $rs.gdall} checked{/if} />
								<input type="radio" name="ico" title="{lang禁用}" value="0"{if !$rs.gdall} checked{/if} />
							</div>
							<div class="layui-form-mid layui-word-aux">{lang即上传后，自动生成一张后台缩略图，方便后台预览，禁用后将直接使用原图}</div>
						</div>
					</div>
					<div class="layui-form-item layui-layout-admin">
						<div class="layui-input-block">
							<div class="layui-footer"  style="left: 0;z-index:10">
								<button class="layui-btn" lay-submit="" lay-filter="component-form-demo1">立即提交</button>
								<button type="reset" class="layui-btn layui-btn-primary">重置</button>
							</div>
						</div>
					</div>
				</div>
			</form>
		</div>
	</div>
</div>
<script type="text/javascript">
    $(document).ready(function(){
        if($("input[name=gdall]:checked").val() == '1'){
            $('#gdsetting').hide()
        } else {
            $('#gdsetting').show()
        }
        $("#catesubmit").submit(function(){
            $(this).ajaxSubmit({
                'url':'{url ctrl=rescate func=save/}',
                'type':'post',
                'dataType':'json',
                'success':function(rs){
                    if(rs.status == 'ok'){
                        var tip = $("#id").val() ? '{lang附件分类编辑成功}' : '{lang附件分类添加成功}';
                        $.dialog.alert(tip,function(){
                            $.phpok.go('{url ctrl=rescate/}');
                        },'succeed');
                    }else{
                        $.dialog.alert(rs.content);
                        return false;
                    }
                }
            });
            return false;
        });
    });
    layui.use('form',function () {
        layui.form.on('radio(gdall)', function(data){
            if(data.value == 1){
                $('#gdsetting').slideUp();
            }else{
                $('#gdsetting').slideDown();
            }

        });
    })
</script>
<!-- include tpl=foot_lay -->