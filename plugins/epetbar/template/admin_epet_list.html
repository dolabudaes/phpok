<!-- include tpl=head_lay -->
<script type="text/javascript">
function epet_remote()
{
	var url = get_plugin_url('epetbar','importdata');
	$.win('同步数据中',url);
	return false;
}
function update_pro(id)
{
	if(!id || id == 'undefined'){
		id = $.checkbox.join();
		if(!id || id == 'undefined'){
			$.dialog.alert('未指定产品');
			return false;
		}
	}
	var url = get_plugin_url('epetbar','update_pro','ids='+$.str.encode(id));
	var tip = $.dialog.tips('正在更新产品…',100).lock();
	$.phpok.json(url,function(rs){
		tip.close();
		if(!rs.status){
			$.dialog.alert(rs.info);
			return false;
		}
		$.dialog.alert('产品更新成功');
		return false;
	});
}
function up_market(id)
{
	if(!id || id == 'undefined'){
		id = $.checkbox.join();
		if(!id || id == 'undefined'){
			$.dialog.alert('未指定产品');
			return false;
		}
	}
	var url = get_plugin_url('epetbar','up_market','ids='+$.str.encode(id));
	var tip = $.dialog.tips('正在上架产品，请耐心等候…',100).lock();
	$.phpok.json(url,function(rs){
		tip.close();
		if(!rs.status){
			$.dialog.alert(rs.info);
			return false;
		}
		$.dialog.tips('产品上架成功').lock();
		$.phpok.reload();
		return false;
	});
}
function down_market(id)
{
	if(!id || id == 'undefined'){
		id = $.checkbox.join();
		if(!id || id == 'undefined'){
			$.dialog.alert('未指定产品');
			return false;
		}
	}
	$.dialog.confirm('确定要下载指定的产品吗？',function(){
		var url = get_plugin_url('epetbar','down_market','ids='+$.str.encode(id));
		$.phpok.json(url,function(rs){
			if(!rs.status){
				$.dialog.alert(rs.info);
				return false;
			}
			$.dialog.tips('产品下架成功').lock();
			$.phpok.reload();
			return false;
		});
	})
}
function pro_del(id)
{
	if(!id || id == 'undefined'){
		id = $.checkbox.join();
		if(!id || id == 'undefined'){
			$.dialog.alert('未指定产品');
			return false;
		}
	}
	$.dialog.confirm('确定要删除指定的产品吗？',function(){
		var url = get_plugin_url('epetbar','del','ids='+$.str.encode(id));
		$.phpok.json(url,function(rs){
			if(!rs.status){
				$.dialog.alert(rs.info);
				return false;
			}
			$.dialog.tips('删除成功').lock();
			$.phpok.reload();
			return false;
		});
	})
}
</script>
<div class="layui-card">
	<div class="layui-card-header">
		<div class="fr">
			<input type="button" value="同步数据" onclick="epet_remote()" class="layui-btn layui-btn-sm" />
		</div>
	</div>
	<div class="layui-card-body layui-form">
		<table class="layui-table">
		<thead>
		<tr>
			<th>ID</th>
			<th>远程ID</th>
			<th>平台ID</th>
			<th>产品名称</th>
			<th>品牌</th>
			<th>主图</th>
			<th>价格</th>
			<th>分销价</th>
			<th>库存</th>
			<th>操作</th>
		</tr>
		</thead>
		<!-- loop from=$rslist key=$key value=$value id=$tmpid -->
		<tr>
			<td><input type="checkbox" value="{$value.id}" title="{$value.id}" lay-skin="primary" /></td>
			<td>{$value.goods_gid}</td>
			<td>{$value.tid}</td>
			<td>
				{$value.goods_title}
				<!-- if !$value.sku_status -->
				<span class="red">远程禁售</span>
				<!-- /if -->
			</td>
			<td>{$value.brand_name}</td>
			<td><!-- if $value.main_picture --><a href="{$value.main_picture}" target="_blank"><img src="{$value.main_picture}" width="80px" /></a><!-- else -->-<!-- /if --></td>
			<td><!-- if $value.sale_price -->{$value.sale_price}<!-- else --><span class="red">未设</span><!-- /if --></td>
			<td>{$value.distribution_price}</td>
			<td><!-- if $value.stock -->{$value.stock}<!-- else --><span class="red">空</span><!-- /if --></td>
			<td>
				<div class="layui-btn-group">
					<input type="button" value="更新产品" onclick="update_pro({$value.id})" class="layui-btn layui-btn-sm" />
					<!-- if $value.is_sell -->
					<input type="button" value="下架" onclick="down_market({$value.id})" class="layui-btn layui-btn-sm layui-btn-warm" />
					<!-- else -->
						<!-- if $value.sale_price && $value.stock && $value.sku_status -->
						<input type="button" value="上架" onclick="up_market({$value.id})" class="layui-btn layui-btn-sm" />
						<!-- /if -->
					<!-- /if -->
					<input type="button" value="删除" onclick="pro_del({$value.id})" class="layui-btn layui-btn-sm layui-btn-danger" />
				</div>
			</td>
		</tr>
		<!-- /loop -->
		</table>
		<div class="layui-row">
			<div class="layui-col-xs12 layui-col-sm6">
		    	<ul class="layout">
		    		<li>
			    		<div class="layui-btn-group">
			    			<input type="button" value="{lang全选}" class="layui-btn layui-btn-primary layui-btn-sm" onclick="$.input.checkbox_all()" />
							<input type="button" value="{lang全不选}" class="layui-btn layui-btn-primary layui-btn-sm" onclick="$.input.checkbox_none()" />
							<input type="button" value="{lang反选}" class="layui-btn layui-btn-primary layui-btn-sm" onclick="$.input.checkbox_anti()" />
			    		</div>
		    		</li>
		    		<li>
			    		<div class="layui-btn-group">
			    			<input type="button" value="{lang更新产品}" class="layui-btn layui-btn-sm" onclick="update_pro()" />
							<input type="button" value="{lang上架}" class="layui-btn layui-btn-sm" onclick="up_market()" />
							<input type="button" value="{lang下架}" class="layui-btn layui-btn-sm layui-btn-warm" onclick="down_market()" />
							<input type="button" value="{lang删除}" class="layui-btn layui-btn-sm layui-btn-danger" onclick="pro_del()" />
			    		</div>
		    		</li>
		    	</ul>
			</div>
			<div class="layui-col-xs12 layui-col-sm6">
				<!-- include tpl=pagelist -->
			</div>
		</div>
		
	</div>
</div>
<!-- include tpl=foot_lay -->